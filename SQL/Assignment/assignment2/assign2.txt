create table EMP
(
empno int,
ename varchar(30),
job varchar(30),
mgrid int,
hiredate datetime,
sal float,
comm varchar(30),
deptno int
)
Insert into EMP values
(7369  ,'  SMITH','     CLERK',	      		7902   	,	'17-DEC-80' ,    	 800	,'',         20),
(7499 ,  ' ALLEN',    ' SALESMAN',    		 7698,   	'20-FEB-81',    	 1600  ,'   300 ',   30),
(7521,  '  WARD',	'  SALESMAN',        	7698 ,   	'22-FEB-81',  	 1250,    ' 500 ',   30),
(7566 , '  JONES',   '  MANAGER',       	7839 ,  	 	'02-APR-81' ,  	 2975, '' ,          20),
(7654,   ' MARTIN',  ' SALESMAN',     		 7698,   	 '28-SEP-81',  	 1250 ,'   1400',    30),
(7698,	'BLAKE',    ' MANAGER', 	   	 7839, 	    	 '01-MAY-81',       2850,'',            30),
(7782 , 	'CLARK',    ' MANAGER',      		 7839  ,  	'09-JUN-81',   	 2450 ,'',           10),
(7788,  	'SCOTT',     'ANALYST',      		 7566   ,	' 19-APR-87 ',     3000,'',             20),
(7839 ,   'KING',      'PRESIDENT',            	null		,' 17-NOV-81',      5000,''  ,           10),
(7844 ,   'TURNER',   ' SALESMAN',      	7698,    	'08-SEP-81',    	 1500,     ' 0'   ,  30),
(7876 ,   'ADAMS',    ' CLERK' ,        	7788  ,  	'23-MAY-87',        1100,  '',          20),
(7900 ,   'JAMES' ,    'CLERK',        		 7698 ,  	 '03-DEC-81',  	 950, '',            30),
(7902,    'FORD',     ' ANALYST',     		  7566,   	 '03-DEC-81',   	 3000, '',           20),
(7934 ,  ' MILLER',   ' CLERK',        		 7782 ,   	'23-JAN-82',	 1300,'',            10)
select * from EMP
create table dept
(
deptno int,
dname varchar(30),
LOC varchar(30)
)
Insert into dept values
(10 ,'    ACCOUNTING','    NEW YORK' ),
(20 , '   RESEARCH', '     DALLAS' ),
(30,    ' SALES',        ' CHICAGO' ),
(40 ,   ' OPERATIONS ',  ' BOSTON' )
select * from dept
--Q1
select ename from EMP where ename like'A%'
--Q2
select ename from EMP Where mgrid= null
--Q3
select Ename,comm,sal  from EMP Where 1400>sal & sal > 1200
--Q4
select deptno From Dept where dname ='RESEARCH'
--Q5
Select Count(*)
from EMP where job='CLERK'
--6
-- Query to find average salary and count of employees for each job type
SELECT
    job,
    AVG(sal) AS average_salary,
    COUNT(*) AS number_of_employees
FROM
    EMP
GROUP BY
    job;
--7
-- Query to list employees with the lowest and highest salary
SELECT *
FROM EMP
WHERE sal IN (
    SELECT MIN(sal) AS min_sal
    FROM EMP
    
    UNION
    
    SELECT MAX(sal) AS max_sal
    FROM EMP
);
--8
-- Query to list departments with no employees
SELECT *
FROM dept
WHERE deptno NOT IN (
    SELECT DISTINCT deptno
    FROM EMP
);
--9
-- Query to get names and salaries of analysts in department 20 earning more than 1200, sorted by name
SELECT 
    ename,
    sal
FROM 
    EMP
WHERE 
    job= 'ANALYST'
    AND sal > 1200
    AND deptno = 20
ORDER BY 
    ename ASC;
	--10
	-- Query to list department name, number of employees, and total salary paid for each department
SELECT
    d.dname,
    COUNT(e.empno) AS number_of_employees,
    SUM(e.sal) AS total_salary_paid
FROM
    dept d
LEFT JOIN
    EMP e ON d.deptno = e.deptno
GROUP BY
    d.dname;
	--11
select sal from EMP where ename like ('MILLER''SMITH')

--12	
select ename from EMP where ename like 'A%'
or ename like 'M%';
--13
select sal*12 from EMP where ename='SMITH'
--14
-- Query to list name and salary of employees whose salary is not in the range of 1500 and 2850
SELECT
    ename,
    sal
FROM
    EMP
WHERE
    sal < 1500 OR sal > 2850;
	--15
	-- Query to find managers with more than 2 employees reporting to them
SELECT
    e.empno,
    e.ename AS manager_name,
    COUNT(*) AS number_of_reports
FROM
    EMP e
JOIN
    emp r ON e.empno = r.mgrid
GROUP BY
    e.empno, e.ename
HAVING
    COUNT(*) > 2
ORDER BY
    manager_name;
